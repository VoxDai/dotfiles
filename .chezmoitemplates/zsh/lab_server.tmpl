# set proxy control (via SSH tunnel)
PROXY_ADDR="http://127.0.0.1:6152"

proxy_on() {
  export http_proxy="$PROXY_ADDR"
  export https_proxy="$PROXY_ADDR"
  export all_proxy="$PROXY_ADDR"
  export HTTP_PROXY="$PROXY_ADDR"
  export HTTPS_PROXY="$PROXY_ADDR"
  echo "Proxy ON -> $PROXY_ADDR"
}

proxy_off() {
  unset http_proxy https_proxy all_proxy
  unset HTTP_PROXY HTTPS_PROXY
  echo "Proxy OFF"
}

proxy_status() {
  if ss -lnt | grep -q ':6152'; then
    echo "Tunnel: UP (127.0.0.1:6152 listening)"
  else
    echo "Tunnel: DOWN (no local listener)"
  fi

  if env | grep -qi '_proxy='; then
    echo "Proxy env: ON"
  else
    echo "Proxy env: OFF"
  fi
}
